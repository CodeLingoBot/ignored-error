funcs:
- name: HandleError
  type: resolver
  body: |-
    function (returnArgCount, errorPosition, callExpr) {
      var handler = "\t"
      for (pos = 0; pos < returnArgCount; pos++) {
        handler += (pos == errorPosition ? "err": "_")
        handler += (pos == returnArgCount - 1 ? " := " : " , ")
      }

      handler += callExpr
      handler += "\n\tif err != nil {\n\t\tpanic(err.Error())\n\t}"
      return handler
    }
tenets:
- import: codelingo/effective-go/good-package-name
  flows:
    codelingo/docs:
      title: ""
      body: ""
    codelingo/review:
      comment: ""
    codelingo/rewrite:
      place: ""
- import: codelingo/go/ticker-in-for-switch
  flows:
    codelingo/docs:
      title: ""
      body: ""
    codelingo/review:
      comment: ""
    codelingo/rewrite:
      place: ""
- import: codelingo/kubernetes/well-formed-lists
  flows:
    codelingo/docs:
      title: ""
      body: ""
    codelingo/review:
      comment: ""
    codelingo/rewrite:
      place: ""
- import: codelingo/php/if-assignment
  flows:
    codelingo/docs:
      title: ""
      body: ""
    codelingo/review:
      comment: ""
    codelingo/rewrite:
      place: ""
- import: codelingo/kubernetes/flags-have-underscores
  flows:
    codelingo/docs:
      title: ""
      body: ""
    codelingo/review:
      comment: ""
    codelingo/rewrite:
      place: ""
- import: codelingo/cockroachdb/func-args-inline-comments
  flows:
    codelingo/docs:
      title: ""
      body: ""
    codelingo/review:
      comment: ""
    codelingo/rewrite:
      place: ""
- name: do-not-ignore-errors
  flows:
    codelingo/docs:
      title: ""
      body: ""
    codelingo/review:
      comment: ""
    codelingo/rewrite:
      place: ""
  query: |
    import codelingo/ast/go

    go.block_stmt(depth = any): # The call expression is a child of block_stmt without any intervening facts, such as go.assign_stmt.
      go.list:
        go.expr_stmt:
          @review comment
          @rewrite --replace "{{ HandleError(returnArgCount, errorPosition, callExpr) }}"
          go.call_expr:
            raw as callExpr
            edge("calls"):
              go.func_decl:
                go.func_type:
                  go.field_list
                  go.field_list:
                    child_count as returnArgCount
                    go.field:
                      sibling_order as errorPosition
                      go.ident:
                        name == "error"
